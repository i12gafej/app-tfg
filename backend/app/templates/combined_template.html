<!DOCTYPE html>
    <html lang="es">
    <head>
        <meta charset="UTF-8">
        <title>Memoria de Sostenibilidad</title>
        <style>
            @page {
                size: A4;
                margin: 0;
                @bottom-right {
                    content: counter(page);
                    font-size: 12px;
                    color: #666;
                }
            }

            body {
                margin: 0;
                padding: 0;
                font-family: 'Poppins', sans-serif;
                box-sizing: border-box;
                width: 21cm;                     
                height: 29.7cm;                  
            }

            /* ---------- Página de contenido ---------- */
            .page {
                padding: 2.5cm 2cm 2.5cm 2cm;
                min-height: 100%;
                box-sizing: border-box;
                counter-increment: page;
            }

            /* Ocultar números de página en la portada y página de información del recurso */
            .page:first-of-type,
            .page:nth-of-type(2) {
                counter-increment: none;
            }

            .page:first-of-type::after,
            .page:nth-of-type(2)::after {
                content: none;
            }

            /* ---------- Títulos y contenido simple ---------- */
            .simple-title {
                font-size: 1.8em;
                font-weight: bold;
                text-align: center;
                margin-bottom: 1.5em;
            }

            .simple-content {
                font-size: 1.1em;
                line-height: 1.7;
                color: #222;
            }

            /* Estilos para el botón de descarga */
            .download-button {
                position: fixed;
                top: 20px;
                right: 20px;
                background-color: #3498db;
                color: white;
                padding: 12px 24px;
                border: none;
                border-radius: 25px;
                cursor: pointer;
                font-size: 16px;
                font-weight: 600;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                transition: all 0.3s ease;
                z-index: 1000;
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .download-button:hover {
                background-color: #2980b9;
                transform: translateY(-2px);
                box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
            }

            .download-button:active {
                transform: translateY(0);
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }

            .download-icon {
                width: 20px;
                height: 20px;
                fill: currentColor;
            }

            /* Estilos del menú lateral */
            #side-menu {
                position: fixed;
                left: 0;
                top: 0;
                width: 280px;
                height: 100%;
                background: #fff;
                z-index: 2000;
                overflow-y: auto;
                padding-top: 60px;
                box-shadow: 2px 0 8px rgba(0,0,0,0.1);
                transition: transform 0.3s ease;
            }

            #side-menu.collapsed {
                transform: translateX(-280px);
            }

            #toggle-menu {
                position: fixed;
                left: 20px;
                top: 20px;
                z-index: 2001;
                background: #fff;
                border: none;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .menu-section {
                margin: 15px 0;
                padding: 0 20px;
            }

            .menu-section-title {
                font-size: 1.2em;
                font-weight: 600;
                margin-bottom: 10px;
                padding: 8px 12px;
                border-radius: 4px;
            }

            .menu-section-title.paso-1 { background-color: #a8d4ec; }
            .menu-section-title.paso-2 { background-color: #a8cc54; }
            .menu-section-title.paso-3 { background-color: #f8b4c4; }
            .menu-section-title.paso-4 { background-color: #b0acd4; }
            .menu-section-title.paso-5 { background-color: #ffc48c; }

            .menu-item {
                list-style: none;
                margin: 5px 0;
            }

            .menu-item a {
                display: block;
                padding: 8px 12px;
                text-decoration: none;
                color: #333;
                border-radius: 4px;
                transition: background-color 0.2s;
            }

            .menu-item a:hover {
                background-color: #f5f5f5;
            }

            .menu-item.paso-1 a { background-color: #f0f4fc; }
            .menu-item.paso-2 a { background-color: #f0f4e4; }
            .menu-item.paso-3 a { background-color: #ffecf4; }
            .menu-item.paso-4 a { background-color: #e8e4f4; }
            .menu-item.paso-5 a { background-color: #fff4ec; }

            .submenu {
                padding-left: 20px;
                margin: 5px 0;
                display: none;
            }

            .menu-item:hover .submenu {
                display: block;
            }

            .submenu-item {
                list-style: none;
                margin: 3px 0;
            }

            .submenu-item a {
                display: block;
                padding: 6px 12px;
                text-decoration: none;
                color: #555;
                border-radius: 4px;
                transition: background-color 0.2s;
                font-size: 0.9em;
            }

            .submenu-item a:hover {
                background-color: #f5f5f5;
            }
            footer {
                position: fixed;
                bottom: 0;
                right: 0;
                left: 0;
                text-align: right;
                font-size: 12px;
                color: #666;
                }

            @media print {
                #side-menu, #toggle-menu {
                    display: none;
                }
                footer {
                    display: block;
                }
            }

            @media print {
                body, .page, .photo-page {
                    -webkit-print-color-adjust: exact !important;
                    print-color-adjust: exact !important;
                }
                .download-button {
                    display: none;
                }
            }

            .photo-page {
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                box-sizing: border-box;
                padding: 2cm;
            }
            .photo-container {
                max-width: 15cm;
                max-height: 20cm;
                width: 100%;
                height: auto;
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 0 auto;
                padding-top: 2em;
            }

            .photo-img {
                width: 100%;
                height: auto;
                max-height: 20cm;
                object-fit: contain;
                display: block;
                margin: 0 auto;
                border-radius: 0.5em;
                box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            }
            .photo-caption {
                margin-top: 1em;
                text-align: center;
                font-size: 1.1em;
                color: #333;
            }

            /* Estilos globales para los templates parciales */
            .narrow-th { width: 29%; min-width: 100px; max-width: 400px;}
            .tab-cell.empty-cell { width: 7%; min-width: 10px; max-width: 40px; border-right: none !important; border-left: none !important; background: transparent !important; padding: 0; }
            .tab-cell.first-empty-cell { width: 7%; min-width: 10px; max-width: 40px; border-right: none !important; background: transparent !important; padding: 0; }
            .header { background-color: #d4eac7; padding: 10px; font-weight: 400; font-size: 10px; }
            .subheader { background-color: #e1ecf4; padding: 10px; font-weight: 400; font-size: 10px; }
            .table { width: 100%; border-collapse: collapse; margin-top: 20px; margin-left: auto; margin-right: auto; }
            .table th, .table td { padding: 10px; border: 1px solid #000; text-align: left; vertical-align: top; font-size: 14px; }
            .table td[style*="border-right: none"] { border-right: none !important; background: transparent !important; width: 2%; min-width: 10px; max-width: 20px; padding: 0; }
            .table th { font-weight: 600; }
            .table .category { background-color: #f1f8e9; font-weight: 400; }

            .material-topics { margin: 5px 0; }
            .dimension-title { color: #333; font-weight: bold; margin-bottom: 5px; }
            .topic-list { padding-left: 20px; }
            .topic-title { font-weight: bold; color: #444; }
            .topic-description { color: #666; margin-top: 2px; }


        .list-text-item {
            text-align: justify;
            hyphens: auto;
            -webkit-hyphens: auto;
            -moz-hyphens: auto;
            -ms-hyphens: auto;
            word-wrap: break-word;
            overflow-wrap: break-word;
            word-break: break-word;
            max-width: 100%;
        }
        .list-text-item a {
            word-wrap: break-word;
            overflow-wrap: break-word;
            word-break: break-all;
            display: inline-block;
            max-width: 100%;
        }

        .preview_page {
            width: 210mm;
            padding: 20mm;
            margin: 0 auto;
            background: white;
            box-sizing: border-box;
            page-break-after: always;
        }

        </style>
    </head>
    <body>
        <button id="toggle-menu" onclick="toggleMenu()">
            <svg width="24" height="24" viewBox="0 0 24 24">
                <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
            </svg>
        </button>

        <!-- Menú lateral -->
    
    <div id="side-menu">
        <ul>
            <li class="menu-item"><a href="#carta-compromiso">Carta de compromiso</a></li>
            <li class="menu-item"><a href="#mision">Misión</a></li>
            <li class="menu-item"><a href="#vision">Visión</a></li>
            <li class="menu-item"><a href="#valores">Valores</a></li>
            <li class="menu-item"><a href="#normativa">Normativa</a></li>
            <li class="menu-item"><a href="#equipo-sostenibilidad">Organigrama</a></li>
            <li class="menu-item"><a href="#grupos-interes">Análisis de grupos de interés</a></li>
            <li class="menu-item">
                <a href="#diagnostico">Diagnóstico</a>
                <ul class="submenu">
                    <li class="submenu-item"><a href="#diagnostico">Introducción</a></li>
                    <li class="submenu-item"><a href="#asuntos-materialidad">Asuntos de materialidad</a></li>
                    <li class="submenu-item"><a href="#indicadores-diagnostico">Indicadores de diagnóstico</a></li>
                    <li class="submenu-item"><a href="#matriz-materialidad">Matriz de materialidad</a></li>
                    <li class="submenu-item"><a href="#impactos-principales-secundarios">Impactos principales y secundarios</a></li>
                </ul>
            </li>
            <li class="menu-item">
                <a href="#hoja-ruta">Hoja de ruta de la sostenibilidad</a>
                <ul class="submenu">
                    <li class="submenu-item"><a href="#hoja-ruta">Introducción</a></li>
                    <li class="submenu-item"><a href="#plan-accion">Plan de acción</a></li>
                    <li class="submenu-item"><a href="#impactos-accion">Impactos del Plan de acción en las dimensiones del desarrollo sostenible </a></li>
                </ul>
            </li>

            <li class="menu-item"><a href="#difusion">Difusión</a></li>
            <li class="menu-item"><a href="#convenios-colaboracion">Convenios de colaboración</a></li>
            <li class="menu-item"><a href="#bibliografia">Bibliografía</a></li>
            <li class="menu-item"><a href="#galeria-fotografica">Galería fotográfica</a></li>
            
        </ul>
    </div>

        <script>
            function toggleMenu() {
                const menu = document.getElementById('side-menu');
                menu.classList.toggle('collapsed');
            }
        </script>

        <button class="download-button" onclick="window.open('report_{{data.id}}.html', '_blank').print()">
            <svg class="download-icon" viewBox="0 0 24 24">
                <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
            </svg>
            Descargar PDF
        </button>
        <a id="portada"></a>
        {{data.cover | safe}}
        <a id="recurso"></a>
        {{data.resource_info | safe}}
        <a id="indice"></a>
        {{data.index | safe}}
        <a id="carta-compromiso"></a>
        {{data.commitment_letter | safe}}
        <a id="mision"></a>
        {{data.mission | safe}}
        <a id="vision"></a>
        {{data.vision | safe}}
        <a id="valores"></a>
        {{data.values_section | safe}}
        <a id="normativa"></a>
        {{data.norms | safe}}
        <a id="equipo-sostenibilidad"></a>
        {{data.org_chart | safe}}
        
        <a id="grupos-interes"></a>
        {{data.stakeholders | safe}}

        <a id="diagnostico"></a>
        {{data.diagnosis | safe}}
        {{data.topics_table | safe}}
        <a id="asuntos-materialidad"></a>
        {{ data.materiality_text | safe}}
        {{ data.ods_dimensions | safe}}
        {{data.material_topics | safe}}
        <a id="indicadores-diagnostico"></a>
        {{data.diagnosis_indicators | safe}}
        {{data.diagnosis_indicators_tables | safe}}
        <a id="matriz-materialidad"></a>
        {{data.materiality_matrix | safe}}
        {{data.topics_priority_table | safe}}
        <a id="impactos-principales-secundarios"></a>
        {{data.main_secondary_impacts | safe}}
        {{data.main_secondary_impacts_graphs | safe}}
        {{data.impacts_graphs_legend | safe}}

        <a id="hoja-ruta"></a>
        {{data.roadmap | safe}}
        <a id="plan-accion"></a>
        {{data.action_plan | safe}}
        {{data.action_plan_tables | safe}}
        <a id="impactos-accion"></a>
        {{data.internal_consistency | safe}}
        {{data.internal_consistency_legend | safe}}

        <a id="difusion"></a>
        {{data.diffusion | safe}}
        <a id="convenios-colaboracion"></a>
        {{data.agreements | safe}}
        <a id="bibliografia"></a>
        {{data.bibliography | safe}}
        <a id="galeria-fotografica"></a>
        {{data.gallery | safe}}
    </body>
    </html>
    